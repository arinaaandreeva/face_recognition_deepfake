# Модель распознавания лиц, способную противостоять DeepFake-атакам

Модель должна уметь определять один ли человек на реальных фото, а также различать является ли фото реальным или сгенерированным ИИ.
Цель:
Обучение энкодера изображений, работающего для лиц. Он должен обладать следующими характеристиками: 
1. Cosine similarity **близок к единице**, когда на обоих изображениях реальные **фотографии одного и того же человека**. Является позитивным запросом.
2. Cosine similarity **не должен быть близок к единице**, когда на обоих изображениях реальные **фотографии разных людей**, либо одно из изображений содержит **сгенерированное лицо**. Является негативным запросом.


### Описание данных
     На основании соревнования https://codenrock.com/contests/kryptonite-ml-challenge/
     Данные для обучения: https://www.kaggle.com/datasets/peach785/deepfake
     Данные для теста: https://www.kaggle.com/datasets/peach785/test-deepfake
  Данные - реальные и синтетически сгенерированные изображения лиц расположены в папке data.
  ** Структура файлов **
  
        data
        ├── test_public  # тестовые данные
        │   ├── 00000000    # pair_id - ID сравниваемой пары сообщений
        │   │   ├── 0.jpg
        │   │   └── 1.jpg
        │   ├── 00000001
        │   │   ├── 0.jpg
        │   │   └── 1.jpg
        ...
        └── train   # данные для обучения модели
        │   ├── meta.json 
        │   ├── images 
        │   │   ├── 00000000    # label - ID человека
        │   │   │   ├── 0.jpg
        │   │   │   ├── 1.jpg
        │   │   │   ├── 2.jpg
        │   │   │  ...
        │   │   │   └── k_0.jpg
        │   │   ├── 00000001
        │   │   │   ├── 0.jpg
        │   │   │   ├── 1.jpg
        │   │   │   ├── 2.jpg
        │   │   │  ...
        │   │   │   └── k_1.jpg
        ...


meta.json имеет структуру face_index/i.jpg : is_deepfake. Ключ содержит информацию о индексе человека и номере изображения, значение равно 0 для реальных данных и равно 1 для синтетических данных.
   
### Используемые модели

   1. Дообучить Resnet18 на новых данных
   2. Построить модель с архитектурой CNN для сравнения реальных фото
   3. Построить модель CNN+RNN для определния фэйка
   4. Построить Siamese neural network
  
#### Метрика качества EER: 
          import numpy as np
          from sklearn.metrics import roc_curve
          
          def compute_eer(y_true, y_score):
              fpr, tpr, threshold = roc_curve(y_true, y_score)
          
              # заменяем np.inf на max + eps
              eps = 1e-3
              threshold[0] = max(threshold[1:]) + eps
          
              fnr = 1 - tpr
              eer_index = np.nanargmin(np.absolute((fnr - fpr)))
              eer = fnr[eer_index]
              return eer


Используется Triplet Loss: Для обучения модели на тройках данных (якорь, позитивный пример, негативный пример).

### Применение технологии:

1. Безопасность и контроль доступа
   
 - Разблокировка устройств: Например, разблокировка смартфонов, ноутбуков и других гаджетов с помощью распознавания лица.
 - Контроль доступа в помещения: Использование в системах контроля доступа в офисы, банки, аэропорты и другие охраняемые объекты.
 - Пограничный контроль: Идентификация личности на границах и в аэропортах.

2. Финансовые услуги
 
 - Банковские операции: Верификация клиентов при онлайн-платежах, открытии счетов или получении кредитов.
 - Биометрическая аутентификация: Использование в мобильных приложениях банков для подтверждения транзакций.




![image](https://github.com/user-attachments/assets/66e4e9ec-611b-4576-b8ea-1e94bf21e128)

















